input {
  generator {
    lines => [
      "name=Mensaje de prueba 1 kube_namespace=fulanito env=dev blablabla",
      "name=Mensaje de prueba 1 kube_namespace=menganito env=dev blablabla",
      "name=Mensaje de prueba 2 kube_namespace=fulanito env=dev blablabla",
      "name=Mensaje de prueba 2 kube_namespace=menganito env=dev blablabla",
      "name=Mensaje de prueba 1 kube_namespace=fulanito env=prod blablabla",
      "name=Mensaje de prueba 1 kube_namespace=menganito env=prod blablabla",
      "name=Mensaje de prueba 2 kube_namespace=fulanito env=prod blablabla",
      "name=Mensaje de prueba 2 kube_namespace=menganito env=prod blablabla"
    ]
  }

}

filter {
  dissect {
    mapping => {
      "message" => "name=%{name} kube_namespace=%{kube_namespace} env=%{env} %{other}"
    }
  }
}

output {
#  stdout { codec => rubydebug { metadata => true } }
  elasticsearch {
    hosts => ["http://elastic-prod-master-headless:9200"]
#    user => "elastic"
#    password => "xxx"
    index => "logs-demo-%{env}-%{kube_namespace}"
    action => "create"
#    data_stream => "true"
#    data_stream_type => "logs"
#    data_stream_dataset => ""
#    data_stream_namespace => ""
  }
}
