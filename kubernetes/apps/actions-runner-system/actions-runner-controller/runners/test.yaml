---
apiVersion: actions.summerwind.dev/v1alpha1
kind: RunnerSet
metadata:
  name: home-ops
  namespace: actions-runner-system
spec:
  repository: oscaromeu/home-ops
  labels: ["self-hosted-cache"]
  dockerdWithinRunnerContainer: true
  template:
    spec:
      image: ghcr.io/actions/actions-runner-controller/actions-runner-dind:v2.299.1-ubuntu-22.04
      imagePullPolicy: IfNotPresent
      nodeSelector:
        node-role.kubernetes.io/worker: "true"
      containers:
      - name: runner
        volumeMounts:
        - name: var-lib-docker
          mountPath: /var/lib/docker
  volumeClaimTemplates:
  - metadata:
      name: var-lib-docker
    spec:
      accessModes:
      - ReadWriteOnce
      resources:
        requests:
          storage: 10Gi
      storageClassName: local-path

