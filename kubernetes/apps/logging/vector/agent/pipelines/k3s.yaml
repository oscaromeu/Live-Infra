---
sources:
  kubernetes_source:
    type: kubernetes_logs
    #use_apiserver_cache: true
    pod_annotation_fields:
      container_image: container_image
      container_name: container_name
      pod_annotations: pod_annotations
      pod_labels: pod_labels
      pod_name: pod_name

sinks:

  #redis:
  #  type: redis
  #  inputs:
  #    - kubernetes_source
  #  url: redis://dragonfly.datahub.svc.cluster.local:6379/0
  #  key: "k3s_prod"
  #  encoding:
  #    codec: json
  #  batch:
  #    max_bytes: 2049000

  kafka:
    type: kafka
    inputs:
      - kubernetes_source
    bootstrap_servers: redpanda-0.redpanda.datahub.svc.cluster.local.:9093
    topic: k3s-logs
    encoding:
      codec: json
    librdkafka_options:
      ssl.ca.location: "/redpanda-default-cert"
    tls:
      enabled: true
      ca_file: "/redpanda-default-cert/ca.crt"
      verify_certificate: true
      verify_hostname: false
