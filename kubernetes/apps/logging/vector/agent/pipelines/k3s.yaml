---
sources:
  kubernetes_source:
    type: kubernetes_logs
    #use_apiserver_cache: true
    pod_annotation_fields:
      container_image: container_image
      container_name: container_name
      pod_annotations: pod_annotations
      pod_labels: pod_labels
      pod_name: pod_name

sinks:

  #redis:
  #  type: redis
  #  inputs:
  #    - kubernetes_source
  #  url: redis://redis-standalone-master.datahub.svc.cluster.local:6379/0
  #  key: "k3s_prod"
  #  encoding:
  #    codec: json
  #  batch:
  #    max_bytes: 2049000

  #kubernetes:
  #  type: vector
  #  inputs: ["kubernetes_source"]
  #  compression: true
  #  version: "2"
  #  address: vector-aggregator.logging.svc.cluster.local:6010

  kafka:
    type: kafka
    inputs:
      - kubernetes_source
    bootstrap_servers: datahub-cluster-kafka-bootstrap.datahub.svc.cluster.local:9094
    topic: k3s-logs-topic
    encoding:
      codec: json
    sasl:
      enabled: true
      mechanism: "SCRAM-SHA-512"
      username: "datahub-user"
      password: "${KAFKA_PASSWORD:-monitor}"
